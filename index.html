<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="./static/style.css" />
    <title>Regex Timer</title>
  </head>
  <body>
    <header>
      <section>
        <h1>RegExp Timer</h1>
      </section>
    </header>
    <main>
      <section class="intro">
        <p>
          The
          <a
            href="https://owasp.org/www-community/attacks/Regular_expression_Denial_of_Service_-_ReDoS"
            >Regular expression Denial of Service (ReDoS)</a
          >
          attack exploits the implementation of a regular expression engine
          causing them to run in exponential time related to the input size.
          This tool allows you to test various regular expressions against
          different input inside your browser to measure the time it takes to
          test an input against a regular expression in order to illustrate this
          attack.
        </p>
      </section>
      <section class="test">
        <form id="regex-tester">
          <div>
            <label for="regex">Regular Expression:&nbsp;&nbsp;</label>
            <input
              id="regex"
              type="text"
              name="regex"
              required
              placeholder="just an innocent regular expression"
            />
          </div>
          <div>
            <label for="test-string">Test string:&nbsp;&nbsp;</label>
            <input
              id="test-string"
              type="text"
              required
              name="test-string"
              placeholder="a string that will ruin your CPU"
            />
          </div>
          <div>
            <button id="test-button" type="submit">Test</button>
          </div>
        </form>
      </section>
      <section class="result">
        <div>
          <p><kbd id="test-input"></kbd></p>
          <output id="test-output" for="regex test-string">&gt;&gt;</output>
        </div>
      </section>

      <section class="examples">
        <h2>Some basic examples</h2>
        <p>Click the example to load it up for testing.</p>
        <ul class="example-list">
          <li>
            <span
              class="example"
              data-example-string="aaaaaaaaaaaaaaaaaaaaaaaa!"
              >(a+)+b</span
            >
          </li>
          <li>
            <span
              class="example"
              data-example-string="aaaaaaaaaaaaaaaaaaaaaaaa!"
              >([a-zA-Z]+)*b</span
            >
          </li>
          <li>
            <span
              class="example"
              data-example-string="aaaaaaaaaaaaaaaaaaaaaaaa!"
              >(a|aa)+b</span
            >
          </li>
          <li>
            <span
              class="example"
              data-example-string="aaaaaaaaaaaaaaaaaaaaaaaa!"
              >(a|a?)+b</span
            >
          </li>
          <li>
            <span
              class="example"
              data-example-string="aaaaaaaaaaaaaaaaaaaaaaaa!"
              >(.*a){12}b</span
            >
          </li>
        </ul>

        <h2>Some real life examples</h2>
        <p>Click the example to load it up for testing.</p>
        <ul class="example-list">
          <li>
            <span
              class="example"
              data-example-string="http://a.a.a.a.a.a.a.a.a.a.a.a.a.a.a.a.a.a.a.a.a.a.a.a.a.a.a.a.a.a.a"
              >^(.+\.)*localhost$</span
            >
            <p>
              <a href="https://github.com/node-fetch/node-fetch/pull/1611"
                >ReDoS in node-fetch</a
              >
            </p>
          </li>
          <li>
            <span
              class="example"
              data-example-string="@............................travelersinsurance!"
              >@(.*?\.)+([a-z]{2,18})$</span
            >
            <p>A vulnerable attempt at detecting a valid email address</p>
          </li>
        </ul>
      </section>
    </main>
    <footer>
      <section>
        <p>Built by <a href="https://philna.sh/">phil nash</a></p>
      </section>
    </footer>
    <script type="module" src="./static/app.js"></script>
  </body>
</html>
